/**
 * AUTO-GENERATED FILE - DO NOT EDIT
 *
 * Generated by scripts/build-routines.mjs from AssemblyScript sources.
 * Source files: src/routines/*.ts
 *
 * To regenerate: pnpm build:routines
 */

/** argsort routine compiled from src/routines/argsort.ts */
export const ARGSORT_WASM =
  "AGFzbQEAAAABEgJgBX9/f39/AGAGf39/f39/AAIPAQNlbnYGbWVtb3J5AgAAAwUEAAEAAQdSBQthcmdzb3J0X2YzMgAAE2FyZ3NvcnRfYmF0Y2hlZF9mMzIAAQthcmdzb3J0X2Y2NAACE2FyZ3NvcnRfYmF0Y2hlZF9mNjQAAwZtZW1vcnkCAAq0CATYAwIKfwJ9A0AgBCAGSgRAIAIgBkECdGogBjYCACAGQQFqIQYMAQsLQQEhCwNAIAQgC0oEQEEAIQYDQCAGIAQgC2tIBEAgBiALQQF0akEBayIHIAROBEAgBEEBayEHCyAGIAtqQQFrIQ4gBiEFA0AgBSAHTARAIAVBAnQiCCADaiACIAhqKAIANgIAIAVBAWohBQwBCwsgDkEBaiEKIAYiBSEJA0AgBSAOTCAHIApOcQRAIAUgCkwgACADIApBAnRqKAIAIg1BAnRqKgIAIg8gACADIAVBAnRqKAIAIghBAnRqKgIAIhBbcSAPIBBeciAPIA9ccgRAIAIgCUECdGogCDYCACAFQQFqIQUFIAIgCUECdGogDTYCACAKQQFqIQoLIAlBAWohCQwBCwsDQCAFIA5MBEAgAiAJQQJ0aiADIAVBAnRqKAIANgIAIAVBAWohBSAJQQFqIQkMAQsLA0AgByAKTgRAIAIgCUECdGogAyAKQQJ0aigCADYCACAKQQFqIQogCUEBaiEJDAELCyAGIAtBAXRqIQYMAQsLIAtBAXQhCwwBCwsDQCAEIAxKBEAgDEECdCIDIAFqIAAgAiADaigCAEECdGoqAgA4AgAgDEEBaiEMDAELCws5AQN/IARBAnQhCANAIAUgBkoEQCAGIAhsIgcgAGogASAHaiACIAdqIAMgBBAAIAZBAWohBgwBCwsL2QMCCn8CfANAIAQgBkoEQCACIAZBAnRqIAY2AgAgBkEBaiEGDAELC0EBIQsDQCAEIAtKBEBBACEGA0AgBiAEIAtrSARAIAYgC0EBdGpBAWsiByAETgRAIARBAWshBwsgBiALakEBayEOIAYhBQNAIAUgB0wEQCAFQQJ0IgggA2ogAiAIaigCADYCACAFQQFqIQUMAQsLIA5BAWohCiAGIgUhCQNAIAUgDkwgByAKTnEEQCAFIApMIAAgAyAKQQJ0aigCACINQQN0aisDACIPIAAgAyAFQQJ0aigCACIIQQN0aisDACIQYXEgDyAQZHIgDyAPYnIEQCACIAlBAnRqIAg2AgAgBUEBaiEFBSACIAlBAnRqIA02AgAgCkEBaiEKCyAJQQFqIQkMAQsLA0AgBSAOTARAIAIgCUECdGogAyAFQQJ0aigCADYCACAFQQFqIQUgCUEBaiEJDAELCwNAIAcgCk4EQCACIAlBAnRqIAMgCkECdGooAgA2AgAgCkEBaiEKIAlBAWohCQwBCwsgBiALQQF0aiEGDAELCyALQQF0IQsMAQsLA0AgBCAMSgRAIAEgDEEDdGogACACIAxBAnRqKAIAQQN0aisDADkDACAMQQFqIQwMAQsLC0MBBH8gBEEDdCEHIARBAnQhCANAIAUgBkoEQCAGIAdsIgkgAGogASAJaiACIAYgCGxqIAMgBBACIAZBAWohBgwBCwsL";

/** cholesky routine compiled from src/routines/cholesky.ts */
export const CHOLESKY_WASM =
  "AGFzbQEAAAABDgJgA39/fwBgBH9/f38AAg8BA2VudgZtZW1vcnkCAAADBQQAAAEBB1YFDGNob2xlc2t5X2YzMgAADGNob2xlc2t5X2Y2NAABFGNob2xlc2t5X2JhdGNoZWRfZjMyAAIUY2hvbGVza3lfYmF0Y2hlZF9mNjQAAwZtZW1vcnkCAArZBATyAQIDfwF9IAIgAmwhBQNAIAMgBUgEQCABIANBAnRqQwAAAAA4AgAgA0EBaiEDDAELCwNAIAIgBEoEQEEAIQMDQCADIARMBEAgACACIARsIANqQQJ0aioCACEGQQAhBQNAIAMgBUoEQCAGIAEgAiAEbCAFakECdGoqAgAgASACIANsIAVqQQJ0aioCAJSTIQYgBUEBaiEFDAELCyADIARGBEAgASACIARsIANqQQJ0aiAGkTgCAAUgASACIARsIANqQQJ0aiAGIAEgAiADbCADakECdGoqAgCVOAIACyADQQFqIQMMAQsLIARBAWohBAwBCwsL9gECA38BfCACIAJsIQUDQCADIAVIBEAgASADQQN0akQAAAAAAAAAADkDACADQQFqIQMMAQsLA0AgAiAESgRAQQAhAwNAIAMgBEwEQCAAIAIgBGwgA2pBA3RqKwMAIQZBACEFA0AgAyAFSgRAIAYgASACIARsIAVqQQN0aisDACABIAIgA2wgBWpBA3RqKwMAoqEhBiAFQQFqIQUMAQsLIAMgBEYEQCABIAIgBGwgA2pBA3RqIAafOQMABSABIAIgBGwgA2pBA3RqIAYgASACIANsIANqQQN0aisDAKM5AwALIANBAWohAwwBCwsgBEEBaiEEDAELCws1AQN/IAIgAmxBAnQhBQNAIAMgBEoEQCAEIAVsIgYgAGogASAGaiACEAAgBEEBaiEEDAELCws1AQN/IAIgAmxBA3QhBQNAIAMgBEoEQCAEIAVsIgYgAGogASAGaiACEAEgBEEBaiEEDAELCws=";

/** lu routine compiled from src/routines/lu.ts */
export const LU_WASM =
  "AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAADBQQAAQABBz4FBmx1X2YzMgAADmx1X2JhdGNoZWRfZjMyAAEGbHVfZjY0AAIObHVfYmF0Y2hlZF9mNjQAAwZtZW1vcnkCAAqjCQTvAwIFfwJ9IAQgBSAEIAVIGyEJA0AgCCAEIAVsSARAIAhBAnQiCiABaiAAIApqKgIAOAIAIAhBAWohCAwBCwsDQCAEIAdKBEAgAyAHQQJ0aiAHNgIAIAdBAWohBwwBCwsDQCAGIAlIBEAgASAFIAZsIAZqQQJ0aioCAIshCyAGIQAgBkEBaiEHA0AgBCAHSgRAIAEgBSAHbCAGakECdGoqAgCLIgwgC14EQCAMIQsgByEACyAHQQFqIQcMAQsLIAIgBkECdGogADYCACAAIAZHBEBBACEHA0AgBSAHSgRAIAEgBSAGbCAHakECdGoiCCoCACELIAggASAAIAVsIAdqQQJ0aiIIKgIAOAIAIAggCzgCACAHQQFqIQcMAQsLIAMgBkECdGoiBygCACEIIAcgAyAAQQJ0aiIAKAIANgIAIAAgCDYCAAsgASAFIAZsIAZqQQJ0aioCACILQwAAAABcBEAgBkEBaiEAA0AgACAESARAIAEgACAFbCAGakECdGoiByoCACALlSEMIAcgDDgCACAGQQFqIQcDQCAFIAdKBEAgASAAIAVsIAdqQQJ0aiIIIAgqAgAgDCABIAUgBmwgB2pBAnRqKgIAlJM4AgAgB0EBaiEHDAELCyAAQQFqIQAMAQsLCyAGQQFqIQYMAQsLC10BBX8gBCAFbEECdCEIIAQgBSAEIAVIG0ECdCEJIARBAnQhCgNAIAYgB0oEQCAHIAhsIgsgAGogASALaiACIAcgCWxqIAMgByAKbGogBCAFEAAgB0EBaiEHDAELCwvzAwIFfwJ8IAQgBSAEIAVIGyEJA0AgCCAEIAVsSARAIAhBA3QiCiABaiAAIApqKwMAOQMAIAhBAWohCAwBCwsDQCAEIAdKBEAgAyAHQQJ0aiAHNgIAIAdBAWohBwwBCwsDQCAGIAlIBEAgASAFIAZsIAZqQQN0aisDAJkhCyAGIQAgBkEBaiEHA0AgBCAHSgRAIAEgBSAHbCAGakEDdGorAwCZIgwgC2QEQCAMIQsgByEACyAHQQFqIQcMAQsLIAIgBkECdGogADYCACAAIAZHBEBBACEHA0AgBSAHSgRAIAEgBSAGbCAHakEDdGoiCCsDACELIAggASAAIAVsIAdqQQN0aiIIKwMAOQMAIAggCzkDACAHQQFqIQcMAQsLIAMgBkECdGoiBygCACEIIAcgAyAAQQJ0aiIAKAIANgIAIAAgCDYCAAsgASAFIAZsIAZqQQN0aisDACILRAAAAAAAAAAAYgRAIAZBAWohAANAIAAgBEgEQCABIAAgBWwgBmpBA3RqIgcrAwAgC6MhDCAHIAw5AwAgBkEBaiEHA0AgBSAHSgRAIAEgACAFbCAHakEDdGoiCCAIKwMAIAwgASAFIAZsIAdqQQN0aisDAKKhOQMAIAdBAWohBwwBCwsgAEEBaiEADAELCwsgBkEBaiEGDAELCwtdAQV/IAQgBWxBA3QhCCAEIAUgBCAFSBtBAnQhCSAEQQJ0IQoDQCAGIAdKBEAgByAIbCILIABqIAEgC2ogAiAHIAlsaiADIAcgCmxqIAQgBRACIAdBAWohBwwBCwsL";

/** sort routine compiled from src/routines/sort.ts */
export const SORT_WASM =
  "AGFzbQEAAAABDgJgA39/fwBgBH9/f38AAg8BA2VudgZtZW1vcnkCAAADBQQAAQABB0YFCHNvcnRfZjMyAAAQc29ydF9iYXRjaGVkX2YzMgABCHNvcnRfZjY0AAIQc29ydF9iYXRjaGVkX2Y2NAADBm1lbW9yeQIACqcGBOMCAgd/An1BASEJA0AgAiAJSgRAQQAhBQNAIAUgAiAJa0gEQCAFIAlqQQFrIQggBSAJQQF0akEBayIEIAJOBEAgAkEBayEECyAFIgMhBgNAIAQgBk4EQCAGQQJ0IgcgAWogACAHaioCADgCACAGQQFqIQYMAQsLIAhBAWohByADIQYDQCADIAhMIAQgB05xBEAgASAHQQJ0aioCACILIAtcIAEgA0ECdGoqAgAiCiALX3IEQCAAIAZBAnRqIAo4AgAgA0EBaiEDBSAAIAZBAnRqIAs4AgAgB0EBaiEHCyAGQQFqIQYMAQsLA0AgAyAITARAIAAgBkECdGogASADQQJ0aioCADgCACADQQFqIQMgBkEBaiEGDAELCwNAIAQgB04EQCAAIAZBAnRqIAEgB0ECdGoqAgA4AgAgB0EBaiEHIAZBAWohBgwBCwsgBSAJQQF0aiEFDAELCyAJQQF0IQkMAQsLCy0BAn8gAkECdCEFA0AgAyAESgRAIAAgBCAFbGogASACEAAgBEEBaiEEDAELCwvjAgIHfwJ8QQEhCQNAIAIgCUoEQEEAIQUDQCAFIAIgCWtIBEAgBSAJakEBayEIIAUgCUEBdGpBAWsiBCACTgRAIAJBAWshBAsgBSIDIQYDQCAEIAZOBEAgBkEDdCIHIAFqIAAgB2orAwA5AwAgBkEBaiEGDAELCyAIQQFqIQcgAyEGA0AgAyAITCAEIAdOcQRAIAEgB0EDdGorAwAiCyALYiABIANBA3RqKwMAIgogC2VyBEAgACAGQQN0aiAKOQMAIANBAWohAwUgACAGQQN0aiALOQMAIAdBAWohBwsgBkEBaiEGDAELCwNAIAMgCEwEQCAAIAZBA3RqIAEgA0EDdGorAwA5AwAgA0EBaiEDIAZBAWohBgwBCwsDQCAEIAdOBEAgACAGQQN0aiABIAdBA3RqKwMAOQMAIAdBAWohByAGQQFqIQYMAQsLIAUgCUEBdGohBQwBCwsgCUEBdCEJDAELCwstAQJ/IAJBA3QhBQNAIAMgBEoEQCAAIAQgBWxqIAEgAhACIARBAWohBAwBCwsL";

/** triangular-solve routine compiled from src/routines/triangular-solve.ts */
export const TRIANGULAR_SOLVE_WASM =
  "AGFzbQEAAAABDAFgCH9/f39/f39/AAIPAQNlbnYGbWVtb3J5AgAAAwMCAAAHSAMcdHJpYW5ndWxhcl9zb2x2ZV9iYXRjaGVkX2YzMgAAHHRyaWFuZ3VsYXJfc29sdmVfYmF0Y2hlZF9mNjQAAQZtZW1vcnkCAAqtBgKUAwIJfwF9IAMgA2xBAnQhDiADQQJ0IQ8DQCAFIApKBEAgACAKIA5saiELQQAhDANAIAQgDEoEQCAEIApsIAxqIA9sIgggAWohDSACIAhqIRAgBwRAQQAhCANAIAMgCEoEQCANIAhBAnRqKgIAIRFBACEJA0AgCCAJSgRAIBEgCyADIAhsIAlqQQJ0aioCACAQIAlBAnRqKgIAlJMhESAJQQFqIQkMAQsLIAYEQCAQIAhBAnRqIBE4AgAFIBAgCEECdGogESALIAMgCGwgCGpBAnRqKgIAlTgCAAsgCEEBaiEIDAELCwUgA0EBayEIA0AgCEEATgRAIA0gCEECdGoqAgAhESAIQQFqIQkDQCADIAlKBEAgESALIAMgCGwgCWpBAnRqKgIAIBAgCUECdGoqAgCUkyERIAlBAWohCQwBCwsgBgRAIBAgCEECdGogETgCAAUgECAIQQJ0aiARIAsgAyAIbCAIakECdGoqAgCVOAIACyAIQQFrIQgMAQsLCyAMQQFqIQwMAQsLIApBAWohCgwBCwsLlAMCCX8BfCADIANsQQN0IQ4gA0EDdCEPA0AgBSAKSgRAIAAgCiAObGohC0EAIQwDQCAEIAxKBEAgBCAKbCAMaiAPbCIIIAFqIQ0gAiAIaiEQIAcEQEEAIQgDQCADIAhKBEAgDSAIQQN0aisDACERQQAhCQNAIAggCUoEQCARIAsgAyAIbCAJakEDdGorAwAgECAJQQN0aisDAKKhIREgCUEBaiEJDAELCyAGBEAgECAIQQN0aiAROQMABSAQIAhBA3RqIBEgCyADIAhsIAhqQQN0aisDAKM5AwALIAhBAWohCAwBCwsFIANBAWshCANAIAhBAE4EQCANIAhBA3RqKwMAIREgCEEBaiEJA0AgAyAJSgRAIBEgCyADIAhsIAlqQQN0aisDACAQIAlBA3RqKwMAoqEhESAJQQFqIQkMAQsLIAYEQCAQIAhBA3RqIBE5AwAFIBAgCEEDdGogESALIAMgCGwgCGpBA3RqKwMAozkDAAsgCEEBayEIDAELCwsgDEEBaiEMDAELCyAKQQFqIQoMAQsLCw==";

/**
 * Decode base64 to Uint8Array.
 * Uses atob in browsers/Deno, Buffer in Node.js.
 */
function base64ToBytes(base64: string): Uint8Array<ArrayBuffer> {
  // Node.js environment: use Buffer
  if (typeof Buffer !== "undefined" && typeof atob === "undefined") {
    const buffer = Buffer.from(base64, "base64");
    return new Uint8Array(buffer) as Uint8Array<ArrayBuffer>;
  }
  // Browser/Deno: use atob
  const binaryString = atob(base64);
  const bytes = new Uint8Array(binaryString.length);
  for (let i = 0; i < binaryString.length; i++) {
    bytes[i] = binaryString.charCodeAt(i);
  }
  return bytes as Uint8Array<ArrayBuffer>;
}

/** Compiled routine modules, lazily instantiated */
const moduleCache = new Map<string, WebAssembly.Module>();

/**
 * Get a compiled WebAssembly module for a routine.
 * Caches the compiled module for reuse.
 */
export async function getRoutineModule(
  name: string,
): Promise<WebAssembly.Module> {
  if (moduleCache.has(name)) {
    return moduleCache.get(name)!;
  }

  let wasm: string;
  switch (name) {
    case "argsort":
      wasm = ARGSORT_WASM;
      break;
    case "cholesky":
      wasm = CHOLESKY_WASM;
      break;
    case "lu":
      wasm = LU_WASM;
      break;
    case "sort":
      wasm = SORT_WASM;
      break;
    case "triangular-solve":
      wasm = TRIANGULAR_SOLVE_WASM;
      break;
    default:
      throw new Error(`Unknown routine: ${name}`);
  }

  const bytes = base64ToBytes(wasm);
  const module = await WebAssembly.compile(bytes);
  moduleCache.set(name, module);
  return module;
}

/**
 * Get a compiled WebAssembly module synchronously.
 * Useful when async is not available.
 */
export function getRoutineModuleSync(name: string): WebAssembly.Module {
  if (moduleCache.has(name)) {
    return moduleCache.get(name)!;
  }

  let wasm: string;
  switch (name) {
    case "argsort":
      wasm = ARGSORT_WASM;
      break;
    case "cholesky":
      wasm = CHOLESKY_WASM;
      break;
    case "lu":
      wasm = LU_WASM;
      break;
    case "sort":
      wasm = SORT_WASM;
      break;
    case "triangular-solve":
      wasm = TRIANGULAR_SOLVE_WASM;
      break;
    default:
      throw new Error(`Unknown routine: ${name}`);
  }

  const bytes = base64ToBytes(wasm);
  const module = new WebAssembly.Module(bytes);
  moduleCache.set(name, module);
  return module;
}
